#1,2,3 задания
car_brands = {}


workbook = openpyxl.load_workbook('data/electric_cars.xlsx')


sheet = workbook.active


for row in sheet.iter_rows(values_only=True):
    
    for brand in row:
  
        if brand:

            if brand in car_brands:
                car_brands[brand] += 1
            
            else:
                car_brands[brand] = 1


workbook.close()


most_popular_brands = sorted(car_brands.items(), key=lambda x: x[1], reverse=True)[:5]


for brand, count in most_popular_brands:
    print(f"{brand}: {count} упоминаний")
#4 задание
import pandas as pd

# Загружаем данные из файла Excel
df = pd.read_excel('cars.xlsx')

# Группируем данные по году и типу автомобиля и суммируем количество
cars_by_year = df.groupby(['Year', 'Type']).sum()

# Получаем количество электромобилей для определенного года
year = 2022  # Задайте нужный год
electric_cars_count = cars_by_year.loc[(year, 'Electric'), 'Count']

print(f"Количество электромобилей, выпущенных в {year} году: {electric_cars_count}")
